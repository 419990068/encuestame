<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
    xmlns:security="http://www.springframework.org/schema/security"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:context="http://www.springframework.org/schema/context"
    xmlns:p="http://www.springframework.org/schema/p" xmlns:util="http://www.springframework.org/schema/util"
    xmlns:jee="http://www.springframework.org/schema/jee" xmlns:aop="http://www.springframework.org/schema/aop"
    xmlns:tx="http://www.springframework.org/schema/tx"
    xsi:schemaLocation="http://www.springframework.org/schema/beans
       http://www.springframework.org/schema/beans/spring-beans-2.5.xsd
       http://www.springframework.org/schema/aop
       http://www.springframework.org/schema/aop/spring-aop-2.5.xsd
       http://www.springframework.org/schema/tx
       http://www.springframework.org/schema/tx/spring-tx-2.5.xsd
       http://www.springframework.org/schema/security
       http://www.springframework.org/schema/security/spring-security-2.0.1.xsd
       http://www.springframework.org/schema/context
       http://www.springframework.org/schema/context/spring-context-2.5.xsd
       http://www.springframework.org/schema/util
       http://www.springframework.org/schema/util/spring-util-2.5.xsd
       http://www.springframework.org/schema/jee
       http://www.springframework.org/schema/jee/spring-jee-2.5.xsd">

    <bean id="resourceBundleMessageSource"
        class="org.springframework.context.support.ResourceBundleMessageSource">
        <property name="basename">
            <value>messages</value>
        </property>
    </bean>

    <bean id="service" class="org.encuestame.core.service.Service"
        abstract="true">
        <property name="messageSource">
            <ref bean="messageSource" />
        </property>
        <property name="dataEnMeSource">
            <ref bean="dataEnMeSource"></ref>
        </property>
    </bean>

    <bean id="messageSource"
        class="org.encuestame.web.beans.commons.MessageSourceFactoryBean">
        <property name="messagesource" ref="resourceBundleMessageSource" />
    </bean>


    <bean id="dataEnMeSource" class="org.encuestame.core.service.DataSource">
        <property name="stateDao">
            <ref bean="catStateDaoImp"></ref>
        </property>
        <property name="projectDaoImp">
            <ref bean="projectDaoImp"></ref>
        </property>
        <property name="catLocationDao">
            <ref bean="catLocationDao"></ref>
        </property>
         <property name="catLocationTypeDao">
            <ref bean="catLocationTypeDao"></ref>
        </property>
        <property name="clientDao">
            <ref bean="clientDao"></ref>
        </property>
    </bean>

    <bean id="servicesManager" class="org.encuestame.core.service.ServiceManager"
        parent="service">
        <property name="applicationServices">
            <ref bean="applicationServices"></ref>
        </property>
    </bean>

    <bean id="surveyService" class="org.encuestame.core.service.SurveyService"
        parent="service">
        <property name="surveyDaoImp">
            <ref bean="surveyDaoImp"></ref>
        </property>
        <property name="serviceMail">
            <ref bean="serviceMail"></ref>
        </property>
        <property name="questionDaoImp">
            <ref bean="questionDaoImp"></ref>
        </property>
    </bean>

    <bean id="securityService" class="org.encuestame.core.service.SecurityService"
        parent="service">
        <property name="surveyService">
            <ref bean="surveyService"></ref>
        </property>
        <property name="userDao">
            <ref bean="secUserDao"></ref>
        </property>
        <property name="groupDao">
            <ref bean="secGroupDaoImp"></ref>
        </property>
        <property name="permissionDao">
            <ref bean="secPermissionDaoImp"></ref>
        </property>
        <property name="serviceMail">
            <ref bean="serviceMail"></ref>
        </property>
        <property name="suspendedNotification">
            <value>${sec.suspendedNotification}
            </value>
        </property>
    </bean>

    <bean id="applicationServices" class="org.encuestame.core.service.ApplicationServices"
        parent="service">
        <property name="securityService">
            <ref bean="securityService"></ref>
        </property>
        <property name="name">
            <value>${application.name}</value>
        </property>
        <property name="urlImg">
            <value>${application.urlImg}</value>
        </property>
        <property name="encoding">
            <value>${application.encoding}</value>
        </property>
        <property name="apiKeygoogle">
            <value>${application.apiKeygoogle}</value>
        </property>
    </bean>
</beans>
