<ui:composition template="/templates/surveyTemplate.xhtml"
    xmlns="http://www.w3.org/1999/xhtml"
    xmlns:ui="http://java.sun.com/jsf/facelets"
    xmlns:h="http://java.sun.com/jsf/html"
    xmlns:f="http://java.sun.com/jsf/core"
    xmlns:p="http://primefaces.prime.com.tr/ui"
    xmlns:a4j="http://richfaces.org/a4j"
    xmlns:rich="http://richfaces.org/rich">
    <ui:define name="title">TweetPoll</ui:define>
    <ui:define name="panel">
        <h:form>
         <p:accordionPanel width="100%">
             <p:tab title="Personalization">
                <h:commandLink value="Create Tweet" action="createTweetPoll" />
                <br></br>
                <h:commandLink value="List Tweet" action="tweetpoll" />
            </p:tab>
            <p:tab title="Credentials">
                <h:commandLink value="Credentials" action="createTweetPoll" />
            </p:tab>
         </p:accordionPanel>
        </h:form>
    </ui:define>
    <ui:define name="bodyOptions">
        <h:form>
            <p:messages showDetail="true" />
            <p:dataTable var="item" value="#{tweetPolls.listTweets}"
                paginator="true" rows="20" width="100%"
                selection="#{tweetPolls.selectedTweetPoll}"
                selectionMode="single" update="tabDialogView"
                onselectComplete="tweetDialog.show()">
                <p:column>
                    <f:facet name="header">
                        <h:outputText value="Id" />
                    </f:facet>
                    <h:outputText value="#{item.id}" />
                </p:column>

                <p:column>
                    <f:facet name="header">
                        <h:outputText value="Question Name" />
                    </f:facet>
                    <h:outputText
                        value="#{item.questionBean.questionName}" />
                </p:column>
                <p:column>
                    <f:facet name="header">
                        <h:outputText value="Publicada?" />
                    </f:facet>
                    <h:outputText value="#{item.publishPoll}" />
                </p:column>
                <p:column>
                    <f:facet name="header">
                        <h:outputText value="" />
                    </f:facet>
                    <h:outputText value="#{item.publicationDateTweet}" />
                </p:column>
                <p:column>
                    <f:facet name="header">
                        <h:outputText value="TwitterId" />
                    </f:facet>
                    <h:outputText value="#{item.tweetId}" />
                </p:column>
            </p:dataTable>
        </h:form>
            <p:dialog header="Tweet Poll Detail" widgetVar="tweetDialog"
                modal="true" fixedCenter="true" draggable="false"
                width="650px">
                <p:tabView id="tabDialogView">
                    <p:tab title="Details">
                        <h:form style="padding:20px;" id="detailsForm">
                            <p:messages showDetail="true" showSummary="true" />
                            <h:outputText value="#{tweetPolls.selectedTweetPoll.questionBean.questionName}"  style="font-size:16px;font-weight:bold;"/>
                            <ui:fragment rendered="#{tweetPolls.selectedTweetPoll.publishPoll}">
                                <h:panelGrid columns="2" cellpadding="2" cellspacing="2">
                                    <h:outputText value="Fecha Publicado" />
                                    <h:outputText value="#{tweetPolls.selectedTweetPoll.publicationDateTweet}" />
                                    <h:outputText value="Url Tweet" />
                                    <h:outputLink value="#{tweetPolls.selectedTweetPoll.tweetUrl}" target="_blank"><h:outputText value="#{tweetPolls.selectedTweetPoll.tweetUrl}"/></h:outputLink>
                                </h:panelGrid>
                            </ui:fragment>

                            <ui:fragment rendered="#{!tweetPolls.selectedTweetPoll.publishPoll}">


                                <ui:fragment rendered="#{!tweetPolls.editAnswer}">
                                    <p:commandLink value="Edit Answers" action="#{tweetPolls.changeEdit}" update="detailsForm" />
                                </ui:fragment>
                                <ui:fragment rendered="#{tweetPolls.editAnswer}">

                                        <a4j:repeat value="#{tweetPolls.selectedTweetPoll.questionBean.listAnswers}" var="answer">
                                                 <h:panelGrid columns="1" cellpadding="2" cellspacing="2">
                                                 <rich:inplaceInput value="#{answer.answers}">

                                                 </rich:inplaceInput>
                                                 </h:panelGrid>
                                        </a4j:repeat>
                                    <p:commandLink value="Save Edit" action="#{tweetPolls.changeEdit}"  update="detailsForm"/>
                                </ui:fragment>
                            </ui:fragment>
                        </h:form>
                    </p:tab>
                    <p:tab title="Results" rendered="#{tweetPolls.selectedTweetPoll.publishPoll}">
                     <p:pieChart id="display" value="#{tweetPolls.selectedTweetPoll.results}" var="tweet" categoryField=" #{tweet.label}"
                                  dataField="#{tweet.result}" />
                     </p:tab>
                    <p:tab title="Retweets">
                    </p:tab>
                </p:tabView>
            </p:dialog>

    </ui:define>
</ui:composition>
