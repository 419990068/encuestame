<?xml version="1.0" encoding="UTF-8"?>
<project xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://maven.apache.org/POM/4.0.0"
         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">
    <modelVersion>4.0.0</modelVersion>
    <parent>
        <groupId>org.encuestame</groupId>
        <artifactId>web-app</artifactId>
        <version>1.5.0</version>
    </parent>
    <version>1.5.0</version>
    <artifactId>selenium-test</artifactId>
    <packaging>war</packaging>
    <name>Selenium Test</name>
    <profiles>
        <profile>
            <id>functional-test</id>
            <build>
                <plugins>
                    <plugin>
                        <groupId>org.apache.maven.plugins</groupId>
                        <artifactId>maven-failsafe-plugin</artifactId>
                        <version>2.12</version>
                        <executions>
                            <execution>
                                <goals>
                                    <goal>integration-test</goal>
                                    <goal>verify</goal>
                                </goals>
                            </execution>
                        </executions>
                    </plugin>

                    <plugin>
                        <groupId>org.eclipse.jetty</groupId>
                        <artifactId>jetty-maven-plugin</artifactId>
                        <version>${jetty-plugin-version}</version>
                        <executions>
                            <execution>
                            <id>start-jetty</id>
                                <phase>pre-integration-test</phase>
                            <goals>
                                <goal>run</goal>
                            </goals>
                            <configuration>
                                 <scanIntervalSeconds>0</scanIntervalSeconds>
                                 <daemon>true</daemon>
                            </configuration>
                            </execution>
                        <execution>
                            <id>stop-jetty</id>
                            <phase>post-integration-test</phase>
                            <goals>
                                <goal>stop</goal>
                            </goals>
                            </execution>
                        </executions>
                        <configuration>
                            <stopKey>selenium</stopKey>
                            <stopPort>9999</stopPort>
                            <systemProperties>
                                <systemProperty>
                                    <name>encuestame.custom.config</name>
                                    <value>${encuestame.local.properties}</value>
                                </systemProperty>
                            </systemProperties>
                            <connectors>
                                <connector implementation="org.eclipse.jetty.server.nio.SelectChannelConnector">
                                    <port>${jetty.default.port}</port>
                                </connector>
                            </connectors>
                            <webAppConfig>
                                <contextPath>/encuestame</contextPath>
                                <baseResource implementation="org.eclipse.jetty.util.resource.ResourceCollection">
                                    <resourcesAsCSV>src/main/webapp,../../enme-views/src/main/webapp,
                                        ../../../enme-js/resources-enme-war/src/main/resources,
                                        ../../../enme-css/src/main/webapp</resourcesAsCSV>
                                </baseResource>
                                <!-- http://stackoverflow.com/questions/5802096/duplicate-fragment-name-error-jetty-maven-plugin -->
                                <allowDuplicateFragmentNames>true</allowDuplicateFragmentNames>
                            </webAppConfig>
                            <scanIntervalSeconds>0</scanIntervalSeconds>
                            <daemon>true</daemon>
                        </configuration>
                    </plugin>
                  <!--<plugin>-->
                    <!--<groupId>org.codehaus.cargo</groupId>-->
                    <!--<artifactId>cargo-maven2-plugin</artifactId>-->
                    <!--<version>1.2.0</version>-->
                    <!--<configuration>-->
                        <!--<container>-->
                            <!--<containerId>tomcat7x</containerId>-->
                            <!--<zipUrlInstaller>-->
                                <!--<url>file:///Users/jpicado/bin/downloads/apache-tomcat-${tomcat.version}.zip-->
                                <!--</url>-->
                                <!--<downloadDir>${project.build.directory}/downloads</downloadDir>-->
                                <!--<extractDir>${project.build.directory}/extracts</extractDir>-->
                            <!--</zipUrlInstaller>-->
                        <!--</container>-->
                        <!--<configuration>-->
                            <!--<home>${project.build.directory}/tomcat5x/container</home>-->
                        <!--</configuration>-->
                    <!--</configuration>-->
                    <!--<executions>-->
                        <!--<execution>-->
                            <!--<id>start-tomcat</id>-->
                            <!--<phase>pre-integration-test</phase>-->
                            <!--<goals>-->
                                <!--<goal>start</goal>-->
                            <!--</goals>-->
                        <!--</execution>-->
                        <!--<execution>-->
                            <!--<id>stop-tomcat</id>-->
                            <!--<phase>post-integration-test</phase>-->
                            <!--<goals>-->
                                <!--<goal>stop</goal>-->
                            <!--</goals>-->
                        <!--</execution>-->
                    <!--</executions>-->
                <!--</plugin>-->
                    <!--<plugin>-->
                        <!--<groupId>org.apache.tomcat.maven</groupId>-->
                        <!--<artifactId>tomcat7-maven-plugin</artifactId>-->
                        <!--<version>2.1</version>-->
                        <!--<configuration>-->
                            <!--<path>/</path>-->
                        <!--</configuration>-->
                    <!--</plugin>-->
                    <plugin>
                        <groupId>org.codehaus.mojo</groupId>
                        <artifactId>selenium-maven-plugin</artifactId>
                        <executions>
                            <execution>
                                <id>start</id>
                                <phase>pre-integration-test</phase>
                                <goals>
                                    <goal>start-server</goal>
                                </goals>
                                <configuration>
                                    <debug>true</debug>
                                    <background>true</background>
                                    <logOutput>true</logOutput>
                                    <multiWindow>false</multiWindow>
                                </configuration>
                            </execution>
                            <execution>
                                <id>stop</id>
                                <phase>post-integration-test</phase>
                                <goals>
                                    <goal>stop-server</goal>
                                </goals>
                            </execution>
                        </executions>
                    </plugin>
                </plugins>
                <resources>
                    <resource>
                        <directory>src/main/resources/</directory>
                        <includes>
                            <include>*.*</include>
                        </includes>
                        <filtering>true</filtering>
                    </resource>
                </resources>
            </build>
        </profile>
    </profiles>
    <dependencies>
        <!--<dependency>-->
            <!--<groupId>org.encuestame</groupId>-->
            <!--<artifactId>enme-tomcat-app</artifactId>-->
            <!--<version>${project.version}</version>-->
            <!--<type>war</type>-->
        <!--</dependency>-->
        <dependency>
            <groupId>org.encuestame</groupId>
            <artifactId>enme-config</artifactId>
            <version>${encuestame.version}</version>
            <type>war</type>
        </dependency>
        <dependency>
            <groupId>org.encuestame</groupId>
            <artifactId>enme-views</artifactId>
            <version>${encuestame.version}</version>
            <type>war</type>
        </dependency>
        <dependency>
            <groupId>org.seleniumhq.selenium</groupId>
            <artifactId>selenium-java</artifactId>
            <version>${selenium.version}</version>
        </dependency>
        <dependency>
            <groupId>org.seleniumhq.selenium</groupId>
            <artifactId>selenium-firefox-driver</artifactId>
            <version>${selenium.version}</version>
        </dependency>
        <dependency>
            <groupId>org.seleniumhq.selenium</groupId>
            <artifactId>selenium-server</artifactId>
            <version>${selenium.version}</version>
        </dependency>
        <!-- Will bring in once we configure a Chrome option -->
        <!--dependency>
            <groupId>org.seleniumhq.selenium</groupId>
            <artifactId>selenium-chrome-driver</artifactId>
            <version>${selenium.version}</version>
        </dependency-->
        <dependency>
            <groupId>junit</groupId>
            <artifactId>junit</artifactId>
            <scope>test</scope>
        </dependency>
        <!--
             Type "war" listed below makes this a WAR overlay (i.e., incorporating
             another WAR into this project in making a new WAR, with any additional
             WAR configuration provided (here, none) going into the new WAR.
        -->
    </dependencies>
</project>