<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/ xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:a4j="http://richfaces.org/a4j"
	xmlns:rich="http://richfaces.org/rich"
	xmlns:encuestame="http://encuesta.me/encuestame">
<body>
<ui:composition template="/templates/indexTemplate.xhtml">
	<ui:define name="toolbar">
		<encuestame:adminToolBar />
	</ui:define>
	<ui:define name="bodyOptions">
		<h:form>
			<h:panelGrid columns="8">
				<a4j:commandLink value="#{temp.newUser}" action="newUser" />
			</h:panelGrid>
		</h:form>
		<ui:insert name="optionGroup">
			<h2>#{temp.titleUserGroups}</h2>
			<a4j:region id="listGroup">
				<h:form id="formUsers">
					<h:panelGrid columns="9" cellpadding="3">
						<h:panelGroup>
							<h:selectOneMenu id="listActions" immediate="true"
								value="#{userBean.selectedAction}">
								<f:selectItem itemLabel="Seleccione..." itemValue="" />
								<f:selectItem itemLabel="Eliminar" itemValue="1" />
								<f:selectItem itemLabel="Recordar Contrasenia" itemValue="2" />
								<f:selectItem itemLabel="Editor" itemValue="3" />
							</h:selectOneMenu>
							<a4j:commandButton value="Aplicar"
								action="#{userBean.initAction}" reRender="formUsers,listActions"></a4j:commandButton>

						</h:panelGroup>
						<h:panelGroup>

							<h:selectOneMenu id="selectPermission"
								value="#{userBean.selectedPermissionId}"
								requiredMessage="Es necesario un rol">
								<f:selectItems value="#{globalBean.loadListPermissions}" />
							</h:selectOneMenu>
							<h:message for="selectPermission" />
							<a4j:commandButton value="Asignar Rol"
								action="#{userBean.assingPermissions}"></a4j:commandButton>

						</h:panelGroup>
					</h:panelGrid>
					<a4j:status for="listGroup" startText="Procesando...." stopText=""></a4j:status>
					<rich:dataTable id="dataTableGroups" width="100%"
						style="margin: 5px; margin-top: 12px;"
						binding="#{userBean.uiDataUserTable}"
						value="#{userBean.list_unitBeans}" var="unitUser">
						<f:facet name="header">
							<rich:columnGroup>
								<rich:column width="20px">
									<h:selectBooleanCheckbox />
								</rich:column>
								<rich:column>
									<h:outputText value="#{temp.username}" />
								</rich:column>
								<rich:column>
									<h:outputText value="#{temp.name}" />
								</rich:column>
								<rich:column>
									<h:outputText value="#{temp.gruops}" />
								</rich:column>
								<rich:column>
									<h:outputText value="#{temp.roles}" />
								</rich:column>

								<rich:column>

								</rich:column>
							</rich:columnGroup>
						</f:facet>
						<rich:column width="20px">
							<h:selectBooleanCheckbox id="selectAdd"
								binding="#{userBean.checked}" value="1" />
						</rich:column>
						<rich:column>
							<a4j:commandLink value="#{unitUser.username}" rendered="true"
								oncomplete="javascript:Richfaces.showModalPanel('panelUserGroup')"
								reRender="editFormUserUnit">
								<a4j:actionparam name="userId" value="#{unitUser.username}"
									assignTo="#{userBean.processedUserId}"></a4j:actionparam>
							</a4j:commandLink>
						</rich:column>
						<rich:column>
							<h:outputText value="#{unitUser.name}" />
						</rich:column>
						<rich:column>
							<a4j:repeat value="#{unitUser.listGroups}" var="group">
								<h:outputText value="#{group.groupName}" />
							</a4j:repeat>
						</rich:column>
						<rich:column>
							<a4j:repeat value="#{unitUser.listPermission}" var="per">
								<h:outputText value="#{per.description}," />
							</a4j:repeat>
						</rich:column>
						<rich:column>

						</rich:column>
					</rich:dataTable>
					<rich:messages></rich:messages>
				</h:form>
				<rich:modalPanel id="panelUserGroup" autosized="true" width="200"
					height="60" zindex="2000">

					<f:facet name="header">
						<h:panelGroup>
							<h:outputText value="Editar Usuario"></h:outputText>
						</h:panelGroup>
					</f:facet>
					<f:facet name="controls">
						<h:panelGroup>
							<a4j:commandLink
								onclick="Richfaces.hideModalPanel('panelUserGroup')"
								ajaxSingle="true">
								<h:graphicImage value="#{url.img}/icons/close.png" />
							</a4j:commandLink>

						</h:panelGroup>
					</f:facet>
					<h:form id="editFormUserUnit">
						<h:panelGrid columns="2">
							<h:outputLabel value="Id" for="" />
							<h:inputText value="#{userBean.processedUserId}" />
							<h:outputLabel value="Nombre" for="" />
							<h:inputText value="" />

							<h:outputLabel value="Nombre" for="" />
							<h:inputText value="" />

							<h:outputLabel value="Nombre" for="" />
							<h:inputText value="" />

							<h:outputLabel value="Nombre" for="" />
							<h:inputText value="" />



						</h:panelGrid>
					</h:form>
				</rich:modalPanel>


			</a4j:region>

			<ui:fragment rendered="not #{userBean.oneRow}">
				<h3>#{temp.notfoundGroups}</h3>
			</ui:fragment>





		</ui:insert>

		<!--  <h:outputText value="Grupos" />
			<a4j:commandButton value="groups" rendered="true"
				onclick="javascript:Richfaces.showModalPanel('requestStatusDlg',{width:400, top:200})">
			</a4j:commandButton>
			<rich:modalPanel id="requestStatusDlg">
				<h:outputText value="test" />
				<a4j:commandButton id="cancel_id" value="cerrar"
					onclick="Richfaces.hideModalPanel('requestStatusDlg')" />
			</rich:modalPanel>
			-->

	</ui:define>
</ui:composition>



</body>
</html>